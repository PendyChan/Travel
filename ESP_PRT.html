<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 è¥¿è‘¡éå…¸å‹æ·±åº¦ä¹‹æ—…</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #fdfbf7; /* Warm neutral background */
            color: #2d3436;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #d4a373;
            border-radius: 4px;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }

        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        /* Tab active state */
        .tab-active {
            border-bottom: 3px solid #e17055; /* Terracotta */
            color: #e17055;
            font-weight: 700;
        }
        .tab-inactive {
            color: #636e72;
        }
        .tab-inactive:hover {
            color: #e17055;
        }
    </style>
    <!-- Chosen Palette: Warm Neutrals & Earth Tones (Cream #fdfbf7, Terracotta #e17055, Sand #d4a373, Charcoal #2d3436) -->
    <!-- Application Structure Plan: 
         1. Hero Section: Summary of the trip stats and dates.
         2. Visual Overview: Gantt Chart showing the flow of dates vs cities.
         3. Dynamic Itinerary Explorer: The core interactive element. Users select a city/leg to see detailed day-by-day plans focusing on "non-touristy" gems.
         4. Logistics Hub: Dedicated section for the tricky transport legs (Lisbon->Valencia, Madrid->Ronda) with data-driven advice.
         5. Budget Estimator: Simple visualization of cost distribution. 
    -->
    <!-- Visualization & Content Choices:
         - Timeline: Chart.js Bar Chart (Horizontal) to visualize the duration in each city clearly.
         - Itinerary: JS-driven DOM manipulation to switch between cities without page reloads.
         - Logistics: Grid layout with iconography (Unicode) for quick scanning of flight/train times.
         - Context: Text blocks explaining WHY specific "hidden gems" were chosen over tourist traps.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="antialiased">

    <!-- Navigation -->
    <nav class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl font-bold text-gray-800">Iberia<span style="color:#e17055">2026</span></span>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="scrollToSection('overview')" class="text-gray-600 hover:text-orange-600 px-3 py-2 text-sm font-medium">ç¸½è¦½</button>
                    <button onclick="scrollToSection('itinerary')" class="text-gray-600 hover:text-orange-600 px-3 py-2 text-sm font-medium">æ¯æ—¥è¡Œç¨‹</button>
                    <button onclick="scrollToSection('logistics')" class="text-gray-600 hover:text-orange-600 px-3 py-2 text-sm font-medium">äº¤é€šç´°ç¯€</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="bg-[#faeee7] border-b border-orange-100">
        <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-4xl font-extrabold text-gray-900 sm:text-5xl md:text-6xl">
                è¥¿è‘¡æ·±åº¦è¶³çƒä¹‹æ—…
            </h1>
            <p class="mt-4 max-w-2xl mx-auto text-xl text-gray-600">
                2026å¹´2æœˆ14æ—¥ - 2æœˆ27æ—¥ | é‡Œæ–¯æœ¬ â€¢ ç“¦å€«è¥¿äº â€¢ é¦¬å¾·é‡Œ â€¢ é¾é”
            </p>
            <div class="mt-8 flex justify-center gap-4">
                <div class="bg-white p-4 rounded-lg shadow-sm border border-orange-200">
                    <div class="text-3xl font-bold text-[#e17055]">13</div>
                    <div class="text-sm text-gray-500">å¤©æ•¸</div>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-orange-200">
                    <div class="text-3xl font-bold text-[#e17055]">4</div>
                    <div class="text-sm text-gray-500">åŸå¸‚</div>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-orange-200">
                    <div class="text-3xl font-bold text-[#e17055]">1</div>
                    <div class="text-sm text-gray-500">çƒè³½</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Overview & Stats -->
    <section id="overview" class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            
            <!-- Timeline Chart -->
            <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-100">
                <div class="mb-4">
                    <h2 class="text-xl font-bold text-gray-800">è¡Œç¨‹æ™‚é–“è»¸</h2>
                    <p class="text-sm text-gray-500">å„åŸå¸‚åœç•™æ™‚é–“åˆ†ä½ˆ</p>
                </div>
                <div class="chart-container">
                    <canvas id="timelineChart"></canvas>
                </div>
            </div>

            <!-- Trip Philosophy -->
            <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col justify-center">
                <h2 class="text-xl font-bold text-gray-800 mb-4">è¡Œç¨‹è¨­è¨ˆç†å¿µ</h2>
                <p class="text-gray-600 mb-4 leading-relaxed">
                    æœ¬è¡Œç¨‹é¿é–‹éåº¦å•†æ¥­åŒ–çš„æ™¯é»ï¼Œå°ˆæ³¨æ–¼å…·æœ‰æ­·å²æ·±åº¦çš„è§’è½èˆ‡ç•¶åœ°ç”Ÿæ´»æ°›åœã€‚
                </p>
                <ul class="space-y-3">
                    <li class="flex items-start">
                        <span class="text-orange-500 mr-2">âœ¦</span>
                        <span class="text-gray-700"><strong>é‡Œæ–¯æœ¬:</strong> æ¢ç´¢ Mouraria èˆ‡ Marvila å€ï¼Œé«”é©—æ¯” Alfama æ›´åŸå§‹çš„è‘¡å¼ç”Ÿæ´»ã€‚</span>
                    </li>
                    <li class="flex items-start">
                        <span class="text-orange-500 mr-2">âœ¦</span>
                        <span class="text-gray-700"><strong>ç“¦å€«è¥¿äº:</strong> åœ¨ Turia èŠ±åœ’é¨è¡Œï¼Œæ·±å…¥ Ruzafa å‰µæ„è¡—å€ï¼Œè€Œéåƒ…åƒ…æ˜¯ç§‘å­¸åŸã€‚</span>
                    </li>
                    <li class="flex items-start">
                        <span class="text-orange-500 mr-2">âœ¦</span>
                        <span class="text-gray-700"><strong>é¦¬å¾·é‡Œ & é¾é”:</strong> é«”é©—è¥¿ç”²çƒè³½ç‹‚ç†±ï¼Œä¸¦æŒ‘æˆ°ç•¶æ—¥ä¾†å›æ‡¸å´–ä¹‹åŸé¾é”çš„å£¯éº—æ™¯è‰²ã€‚</span>
                    </li>
                </ul>
            </div>
        </div>
    </section>

    <!-- Interactive Itinerary -->
    <section id="itinerary" class="bg-white py-12 border-t border-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold text-gray-900">æ¯æ—¥è©³ç´°è¡Œç¨‹</h2>
                <p class="mt-2 text-gray-600">é»æ“Šä¸‹æ–¹åŸå¸‚åˆ‡æ›æŸ¥çœ‹æ·±åº¦å®‰æ’</p>
            </div>

            <!-- City Tabs -->
            <div class="flex justify-center space-x-2 md:space-x-8 border-b border-gray-200 mb-8 overflow-x-auto">
                <button onclick="switchCity('lisbon')" id="tab-lisbon" class="tab-active px-4 py-4 text-sm md:text-lg font-medium focus:outline-none whitespace-nowrap">
                    é‡Œæ–¯æœ¬ & è¾›ç‰¹æ‹‰ (2/14-18)
                </button>
                <button onclick="switchCity('valencia')" id="tab-valencia" class="tab-inactive px-4 py-4 text-sm md:text-lg font-medium focus:outline-none whitespace-nowrap">
                    ç“¦å€«è¥¿äº (2/18-21)
                </button>
                <button onclick="switchCity('madrid')" id="tab-madrid" class="tab-inactive px-4 py-4 text-sm md:text-lg font-medium focus:outline-none whitespace-nowrap">
                    é¦¬å¾·é‡Œ & é¾é” (2/21-27)
                </button>
            </div>

            <!-- Dynamic Content Area -->
            <div id="itinerary-content" class="min-h-[500px]">
                <!-- Content injected via JS -->
            </div>
        </div>
    </section>

    <!-- Logistics Dashboard -->
    <section id="logistics" class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8 bg-[#fdfbf7]">
        <div class="mb-8">
            <h2 class="text-3xl font-bold text-gray-900">é—œéµäº¤é€šèˆ‡é ç®—</h2>
            <p class="mt-2 text-gray-600">è·¨åœ‹ç§»å‹•èˆ‡é•·é€”æ—…è¡Œçš„é‡è¦æç¤º</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Transport Cards -->
            <div class="lg:col-span-2 space-y-4">
                <div class="bg-white p-6 rounded-lg shadow border-l-4 border-orange-500">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="text-lg font-bold text-gray-800">âœˆï¸ é‡Œæ–¯æœ¬ (LIS) â ç“¦å€«è¥¿äº (VLC)</h3>
                            <p class="text-sm text-gray-500 mt-1">æ—¥æœŸ: 2æœˆ18æ—¥ (é€±ä¸‰)</p>
                        </div>
                        <span class="bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full">å¿…é ˆæå‰é è¨‚</span>
                    </div>
                    <p class="mt-3 text-gray-700 text-sm">
                        é€™æ˜¯æ­¤è¡Œæœ€å›°é›£çš„ç§»å‹•ã€‚å…©åœ°ä¹‹é–“æ²’æœ‰ç›´é”ç«è»Šï¼ˆéœ€ç¶“é¦¬å¾·é‡Œè½‰è»Šè€—æ™‚9å°æ™‚ï¼‰ã€‚
                        <br><strong>å»ºè­°:</strong> æ­ä¹˜ TAP Portugal æˆ– Ryanair ç›´é£›èˆªç­ï¼ˆç´„ 1.5 å°æ™‚ï¼‰ã€‚
                        <br><em>é ç®—: â‚¬50 - â‚¬120 (å–®ç¨‹å«è¡Œæ)</em>
                    </p>
                </div>

                <div class="bg-white p-6 rounded-lg shadow border-l-4 border-blue-500">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="text-lg font-bold text-gray-800">ğŸš… ç“¦å€«è¥¿äº â é¦¬å¾·é‡Œ</h3>
                            <p class="text-sm text-gray-500 mt-1">æ—¥æœŸ: 2æœˆ21æ—¥ (é€±å…­)</p>
                        </div>
                        <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">AVE / Iryo / Ouigo</span>
                    </div>
                    <p class="mt-3 text-gray-700 text-sm">
                        è¥¿ç­ç‰™é«˜éµéå¸¸ç™¼é”ã€‚è»Šç¨‹ç´„ 1å°æ™‚50åˆ†ã€‚
                        <br><strong>å»ºè­°:</strong> é è¨‚ä¸­åˆå·¦å³çš„ç­æ¬¡ï¼ŒæŠµé”é¦¬å¾·é‡Œå¾Œå‰›å¥½ Check-in ä¸¦ç‚ºéš”å¤©çƒè³½æš–èº«ã€‚
                        <br><em>é ç®—: â‚¬20 - â‚¬50</em>
                    </p>
                </div>

                <div class="bg-white p-6 rounded-lg shadow border-l-4 border-red-500">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="text-lg font-bold text-gray-800">ğŸš„ é¦¬å¾·é‡Œ â‡„ é¾é” (Ronda) ä¸€æ—¥éŠ</h3>
                            <p class="text-sm text-gray-500 mt-1">æ—¥æœŸ: 2æœˆ23æ—¥ (é€±ä¸€)</p>
                        </div>
                        <span class="bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full">é«˜é›£åº¦é è­¦</span>
                    </div>
                    <p class="mt-3 text-gray-700 text-sm">
                        é¦¬å¾·é‡Œè·é›¢é¾é”éå¸¸é ã€‚é€™ä¸æ˜¯å…¸å‹çš„ä¸€æ—¥éŠè·é›¢ã€‚
                        <br><strong>äº¤é€šæ–¹æ¡ˆ:</strong> é¦¬å¾·é‡Œ Atocha æ­ä¹˜é«˜éµè‡³ <strong>Antequera-Santa Ana</strong> æˆ– <strong>CÃ³rdoba</strong> (ç´„ 1.5-2å°æ™‚)ï¼Œå†è½‰ä¹˜å€é–“ç«è»Šæˆ–å·´å£«è‡³ Ronda (ç´„ 1-1.5å°æ™‚)ã€‚å–®ç¨‹ç¸½è€—æ™‚ç´„ 3.5-4 å°æ™‚ã€‚
                        <br><strong>å»ºè­°:</strong> å¿…é ˆæ­ä¹˜æ—©ä¸Š 07:00 çš„ç«è»Šï¼Œä¸¦é è¨ˆæ™šä¸Š 22:00 å›åˆ°é¦¬å¾·é‡Œã€‚é›–ç„¶è¾›è‹¦ï¼Œä½†å³½è°·æ™¯è‰²å€¼å¾—ã€‚
                    </p>
                </div>
            </div>

            <!-- Budget Chart -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-lg font-bold text-gray-800 mb-4">é ç®—åˆ†é…ä¼°ç®—</h3>
                <div class="chart-container" style="height: 300px;">
                    <canvas id="budgetChart"></canvas>
                </div>
                <div class="mt-4 text-xs text-gray-500 text-center">
                    *ä¸å«åœ‹éš›æ©Ÿç¥¨ï¼Œä»¥ä¸­é«˜èˆ’é©åº¦ä¼°ç®—
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="mb-2">2026 Spain & Portugal Trip Planner</p>
            <p class="text-gray-400 text-sm">Designed for Exploration, Not Just Tourism.</p>
        </div>
    </footer>

    <script>
        // --- Data Layer ---
        const itineraryData = {
            lisbon: [
                {
                    date: "2/14 (å…­)",
                    title: "æŠµé”é‡Œæ–¯æœ¬",
                    activities: [
                        { time: "23:25", desc: "æŠµé”é‡Œæ–¯æœ¬æ©Ÿå ´ (LIS)", highlight: true },
                        { time: "00:30", desc: "æ­ä¹˜ Bolt/Uber å‰å¾€å¸‚å€é£¯åº— (å»ºè­°ä½ Intendente æˆ– PrÃ­ncipe Real å€ï¼Œè¼ƒæœ‰å€‹æ€§)", highlight: false }
                    ]
                },
                {
                    date: "2/15 (æ—¥)",
                    title: "éå…¸å‹çš„é‡Œæ–¯æœ¬ï¼šå·¥æ¥­é¢¨èˆ‡èˆŠåŸå€",
                    intro: "é¿é–‹éŠå®¢çˆ†æ»¿çš„å•†æ¥­å»£å ´ï¼Œå¾ç•¶åœ°äººçš„è¦–è§’çœ‹é‡Œæ–¯æœ¬ã€‚",
                    activities: [
                        { time: "10:00", desc: "æ—©é¤å¾Œå‰å¾€ **LX Factory**ã€‚é€™æ˜¯ç”±å»¢æ£„ç´¡ç¹”å» æ”¹å»ºçš„æ–‡å‰µåœ’å€ï¼Œå……æ»¿è¡—é ­å¡—é´‰ã€è¨­è¨ˆå°åº—å’Œå…¨ä¸–ç•Œæœ€ç¾çš„æ›¸åº—ä¹‹ä¸€ Ler Devagarã€‚", highlight: true },
                        { time: "14:00", desc: "å‰å¾€è²å€«å€ï¼Œä½†è·³éä¿®é“é™¢æ’éšŠã€‚æ”¹å» **MAAT (è—è¡“å»ºç¯‰èˆ‡ç§‘æŠ€åšç‰©é¤¨)**ï¼Œæ¬£è³å…¶æµç·šå‹å»ºç¯‰ä¸¦åœ¨æ²³å²¸æ•£æ­¥ã€‚", highlight: false },
                        { time: "18:00", desc: "æ™šé¤å»ºè­°åœ¨ **Time Out Market** é™„è¿‘çš„ Cais do SodrÃ© å€åŸŸæ‰¾å°‹æµ·é®®ç½é ­ä¸»é¡Œé¤å»³ã€‚", highlight: false }
                    ]
                },
                {
                    date: "2/16 (ä¸€)",
                    title: "æ­·å²èˆ‡è¦–é‡ï¼šMouraria å€",
                    intro: "Alfama å€éŠå®¢å¤ªå¤šï¼ŒMouraria æ‰æ˜¯ Fado éŸ³æ¨‚çœŸæ­£çš„ç™¼æºåœ°ï¼Œæ›´å…·åº¶æ°‘æ°£æ¯ã€‚",
                    activities: [
                        { time: "09:30", desc: "æ¼«æ­¥ **Mouraria** å€ï¼Œé€™è£¡æ›¾ç¶“æ˜¯æ‘©çˆ¾äººå±…ä½åœ°ï¼Œå··å¼„æ¯” Alfama æ›´æ›²æŠ˜ã€‚", highlight: true },
                        { time: "11:30", desc: "ç™»ä¸Š **Miradouro da Senhora do Monte** (å±±é ‚è–æ¯è§€æ™¯å°)ã€‚é€™æ˜¯å¸‚å…§æœ€é«˜çš„è§€æ™¯å°ï¼Œè¦–é‡æ¯”è–éœ²è¥¿äºæ›´å£¯è§€ï¼Œä¸”å¤šç‚ºå¹´è¼•äººèšé›†ã€‚", highlight: true },
                        { time: "15:00", desc: "ä¸‹åˆå‰å¾€ **Marvila** å€ (æ±é‚Š)ï¼Œé€™è£¡æ˜¯ç²¾é‡€å•¤é…’èˆ‡è—è¡“ç•«å»Šçš„æ–°èˆˆèšè½ï¼Œå®Œå…¨æ²’æœ‰è§€å…‰åœ˜ã€‚", highlight: false },
                        { time: "20:00", desc: "åœ¨å°é…’é¤¨è†è½ä¸€å ´éå•†æ¥­åŒ–çš„ Fado æ¼”å‡ºã€‚", highlight: false }
                    ]
                },
                {
                    date: "2/17 (äºŒ)",
                    title: "è¾›ç‰¹æ‹‰ (Sintra) ç¥ç§˜ä¸€æ—¥éŠ",
                    intro: "è¾›ç‰¹æ‹‰ä¸åƒ…åƒ…æ˜¯ä½©ç´å®®ã€‚æˆ‘å€‘è¦å»æ›´ç¥ç§˜çš„åœ°æ–¹ã€‚",
                    activities: [
                        { time: "08:30", desc: "æ­ä¹˜ç«è»Šå‰å¾€è¾›ç‰¹æ‹‰ã€‚", highlight: false },
                        { time: "10:00", desc: "è·³éä½©ç´å®®(äººå¤ªå¤š)ã€‚é¦–ç«™å‰å¾€ **Quinta da Regaleira (é›·åŠ èŠæ‹‰èŠåœ’)**ã€‚é€™è£¡æœ‰è‘—åçš„ã€Œå•Ÿè’™æ·±äº•ã€å’Œå……æ»¿è±¡å¾µæ„ç¾©çš„åœ°ä¸‹è¿·å®®ï¼Œæ°£æ°›ç¥ç§˜ã€‚", highlight: true },
                        { time: "13:30", desc: "åœ¨è¾›ç‰¹æ‹‰èˆŠåŸå€åˆé¤ï¼Œå“åš Travesseiros ç”œé»ã€‚", highlight: false },
                        { time: "15:00", desc: "å‰å¾€ **Monserrate Palace (è’™å¡æ‹‰ç‰¹å®®)**ã€‚é€™æ˜¯èåˆäº†é˜¿æ‹‰ä¼¯èˆ‡å“¥å¾·é¢¨æ ¼çš„ç²¾ç·»å®®æ®¿ï¼Œæ“æœ‰çµ•ç¾çš„ç•°åœ‹æ¤ç‰©åœ’ï¼ŒéŠå®¢ç¨€å°‘ï¼Œæ¥µåº¦å¯§éœã€‚", highlight: true },
                        { time: "19:00", desc: "è¿”å›é‡Œæ–¯æœ¬ã€‚", highlight: false }
                    ]
                }
            ],
            valencia: [
                {
                    date: "2/18 (ä¸‰)",
                    title: "é£›å‘åœ°ä¸­æµ·ï¼šç“¦å€«è¥¿äº",
                    intro: "å¾å¤§è¥¿æ´‹å²¸é£›å¾€åœ°ä¸­æµ·ï¼Œæ„Ÿå—æˆªç„¶ä¸åŒçš„é™½å…‰èˆ‡ç¾ä»£æ„Ÿã€‚",
                    activities: [
                        { time: "ä¸Šåˆ", desc: "æ­ä¹˜é£›æ©Ÿå‰å¾€ç“¦å€«è¥¿äº (VLC)ã€‚", highlight: true },
                        { time: "14:00", desc: "å…¥ä½ **Ruzafa** å€ã€‚é€™è£¡æ˜¯ç“¦å€«è¥¿äºçš„ Hipster å€ï¼Œå……æ»¿å¾©å¤åº—ã€å’–å•¡å»³å’Œè—å»Šã€‚", highlight: false },
                        { time: "16:30", desc: "ç§Ÿå€Ÿè‡ªè¡Œè»Šï¼Œæ²¿è‘— **Turia Gardens (åœ–é‡ŒäºèŠ±åœ’)** é¨è¡Œã€‚é€™æ˜¯ç”±ä¹¾æ¶¸æ²³åºŠæ”¹å»ºçš„å¸¶ç‹€å…¬åœ’ï¼Œç©¿è¶Šæ•´å€‹åŸå¸‚ï¼Œéå¸¸èˆ’é©ã€‚", highlight: true },
                        { time: "19:00", desc: "åœ¨ **Mercado de ColÃ³n** (å“¥å€«å¸ƒå¸‚å ´) äº«ç”¨ Tapas æ™šé¤ã€‚é€™è£¡å»ºç¯‰è¯éº—ï¼Œæ¯”ä¸­å¤®å¸‚å ´æ›´é©åˆå¤œé–“èšé¤ã€‚", highlight: false }
                    ]
                },
                {
                    date: "2/19 (å››)",
                    title: "æœªä¾†èˆ‡å‚³çµ±",
                    intro: "ç“¦å€«è¥¿äºæ˜¯è¥¿ç­ç‰™æµ·é®®ç‡‰é£¯(Paella)çš„ç™¼æºåœ°ã€‚",
                    activities: [
                        { time: "10:00", desc: "åƒè§€ **è—è¡“ç§‘å­¸åŸ (City of Arts and Sciences)**ã€‚å³ä½¿ä¸é€²å»æ°´æ—é¤¨ï¼Œå…‰æ˜¯å»ºç¯‰æœ¬èº«ï¼ˆCalatrava è¨­è¨ˆï¼‰å°±å€¼å¾—èŠ±åŠå¤©æ‹ç…§ã€‚", highlight: true },
                        { time: "13:30", desc: "å‰å¾€æµ·é‚Šçš„ **Malvarrosa** æµ·ç˜ï¼Œåœ¨è€å­—è™Ÿé¤å»³äº«ç”¨æ­£å®—çš„ **Paella Valenciana** (æ³¨æ„ï¼šæ­£å®—çš„æ˜¯åŠ å…”è‚‰èˆ‡é›è‚‰ï¼Œä¸æ˜¯æµ·é®®)ã€‚", highlight: true },
                        { time: "16:00", desc: "æ¼«æ­¥ **El Carmen** èˆŠåŸå€ï¼Œå°‹æ‰¾è‘—åçš„è¡—é ­å¡—é´‰è—è¡“ã€‚", highlight: false }
                    ]
                },
                {
                    date: "2/20 (äº”)",
                    title: "è‡ªç„¶ç§˜å¢ƒ Albufera",
                    intro: "ç¨å¾®é é›¢å¸‚å€ï¼Œäº«å—å¯§éœçš„æ—¥è½ã€‚",
                    activities: [
                        { time: "10:00", desc: "å‰å¾€ **çµ²ç¶¢äº¤æ˜“æ‰€ (La Lonja de la Seda)**ï¼Œå“¥å¾·å¼å»ºç¯‰çš„å‚‘ä½œ (UNESCO ä¸–ç•Œéºç”¢)ã€‚", highlight: false },
                        { time: "15:00", desc: "æ­ä¹˜å…¬è»Šå‰å¾€ **Albufera Natural Park**ã€‚", highlight: true },
                        { time: "17:00", desc: "æ­ä¹˜å‚³çµ±æœ¨èˆ¹éŠæ¹–ï¼Œé€™è£¡æ˜¯è¥¿ç­ç‰™è§€è³æ—¥è½æœ€ç¾çš„åœ°æ–¹ä¹‹ä¸€ã€‚æ„Ÿå—ã€Œæ°´ç¨»ç”°ã€èˆ‡å¹³éœæ¹–é¢çš„å€’å½±ã€‚", highlight: true },
                        { time: "20:30", desc: "å›åˆ°å¸‚å€ï¼Œäº«å—ç“¦å€«è¥¿äºçš„å¤œç”Ÿæ´»ã€‚", highlight: false }
                    ]
                }
            ],
            madrid: [
                {
                    date: "2/21 (å…­)",
                    title: "å‰é€²é¦¬å¾·é‡Œ",
                    activities: [
                        { time: "11:00", desc: "æ­ä¹˜é«˜éµ (AVE/Ouigo) å‰å¾€é¦¬å¾·é‡Œ (ç´„ 1h 50m)ã€‚", highlight: true },
                        { time: "14:00", desc: "æŠµé”é¦¬å¾·é‡Œã€‚å»ºè­°ä½å®¿ï¼šAtocha è»Šç«™é™„è¿‘ (äº¤é€šæ–¹ä¾¿) æˆ– La Latina å€ (æ°£æ°›å¥½)ã€‚", highlight: false },
                        { time: "16:00", desc: "åƒè§€ **Reina SofÃ­a Museum (ç´¢è²äºç‹åè—è¡“ä¸­å¿ƒ)**ï¼Œå¿…çœ‹ç•¢å¡ç´¢çš„ã€Šæ ¼çˆ¾å°¼å¡ã€‹ã€‚é€±æœ«å‚æ™šæœ‰æ™‚å…è²»å…¥å ´ã€‚", highlight: true },
                        { time: "20:00", desc: "åœ¨ Cava Baja è¡—äº«ç”¨æ™šé¤ï¼Œé€™è£¡æœ‰é¦¬å¾·é‡Œæœ€å¯†é›†çš„ Tapas é…’å§ã€‚", highlight: false }
                    ]
                },
                {
                    date: "2/22 (æ—¥)",
                    title: "âš½ æ¯”è³½æ—¥ Match Day",
                    intro: "ä»Šæ—¥é‡å¿ƒå…¨åœ¨çƒè³½ã€‚è¥¿ç”²çš„æ°£æ°›åœ¨é–‹è³½å‰å…©å°æ™‚å°±é–‹å§‹äº†ã€‚",
                    activities: [
                        { time: "ä¸Šåˆ", desc: "è¼•é¬†è¡Œç¨‹ã€‚å‰å¾€ **El Rastro è·³èš¤å¸‚å ´** (åƒ…é€±æ—¥é–‹æ”¾)ã€‚é«”é©—ç•¶åœ°äººæ·˜å¯¶çš„æ¨‚è¶£ã€‚", highlight: true },
                        { time: "14:00", desc: "åˆä¼‘ (Siesta)ã€‚ç‚ºäº†æ™šä¸Šçš„çƒè³½å„²å‚™é«”åŠ›ã€‚", highlight: false },
                        { time: "17:00", desc: "å‰å¾€çƒå ´å‘¨é‚Šã€‚ç„¡è«–æ˜¯ä¼¯ç´çƒé‚„æ˜¯å¤§éƒ½æœƒçƒå ´ï¼Œè³½å‰çƒè¿·æœƒåœ¨å‘¨é‚Šé…’å§èšé›†å”±æ­Œã€‚", highlight: true },
                        { time: "TBD", desc: "**è§€çœ‹çƒè³½**ã€‚äº«å—ä¸–ç•Œé ‚ç´šè¶³çƒç››å®´ã€‚", highlight: true }
                    ]
                },
                {
                    date: "2/23 (ä¸€)",
                    title: "æ‡¸å´–ä¹‹åŸï¼šé¾é” (Ronda) é å¾",
                    intro: "é€™æ˜¯ä¸€è¶Ÿé•·é€”è·‹æ¶‰ï¼Œä½†ç‚ºäº†é‚£åº§æ©«è·¨å³½è°·çš„æ–°æ©‹ (Puente Nuevo)ï¼Œå€¼å¾—ã€‚",
                    activities: [
                        { time: "07:00", desc: "æ­ä¹˜æ—©ç­ç«è»Šç¶“ Cordoba/Antequera è½‰è»Šå‰å¾€ Rondaã€‚", highlight: true },
                        { time: "11:30", desc: "æŠµé” Rondaã€‚ç›´å¥” **Puente Nuevo (æ–°æ©‹)**ã€‚èµ°ä¸‹å³½è°·çš„å°å¾‘ (Camino to the viewpoint) æ‹æ”æ©‹çš„å…¨æ™¯ã€‚", highlight: true },
                        { time: "13:30", desc: "åƒè§€è¥¿ç­ç‰™æœ€å¤è€çš„é¬¥ç‰›å ´ Plaza de Torosã€‚", highlight: false },
                        { time: "15:00", desc: "åœ¨å³½è°·é‚Šçš„å’–å•¡å»³ä¼‘æ¯ã€‚", highlight: false },
                        { time: "17:30", desc: "æ­ä¹˜ç«è»Š/å·´å£«è¿”å›é¦¬å¾·é‡Œã€‚", highlight: false },
                        { time: "21:30", desc: "æŠµé”é¦¬å¾·é‡Œï¼Œç–²æ†Šä½†æ»¿è¶³ã€‚", highlight: false }
                    ]
                },
                {
                    date: "2/24 (äºŒ)",
                    title: "é¦¬å¾·é‡Œå†·é–€ç¾å­¸",
                    intro: "é¿é–‹çš‡å®®ï¼Œå»ä¸€äº›åœ¨åœ°äººå–œæ„›çš„æ–‡åŒ–æ“šé»ã€‚",
                    activities: [
                        { time: "10:00", desc: "å‰å¾€ **Matadero Madrid**ã€‚é€™æ˜¯ç”±å± å®°å ´æ”¹å»ºçš„ç•¶ä»£è—è¡“ä¸­å¿ƒï¼Œå»ºç¯‰é¢¨æ ¼ç¨ç‰¹ï¼Œå±•è¦½å‰è¡›ã€‚", highlight: true },
                        { time: "13:00", desc: "æ²¿è‘— Manzanares æ²³å²¸æ•£æ­¥ã€‚", highlight: false },
                        { time: "16:00", desc: "åƒè§€ **Sorolla Museum**ã€‚é€™æ˜¯ç•«å®¶ Sorolla çš„æ•…å±…ï¼Œæ“æœ‰ç¾éº—çš„å®‰é”é­¯è¥¿äºå¼åº­é™¢ï¼Œå…‰å½±æ¥µç¾ï¼Œéå¸¸å¯§éœã€‚", highlight: true },
                        { time: "19:00", desc: "å‰å¾€ **Temple of Debod (å¾·æ³¢ç¥å»Ÿ)** çœ‹æ—¥è½ã€‚é€™æ˜¯è²¨çœŸåƒ¹å¯¦çš„åŸƒåŠå¤è¹Ÿï¼Œä¹Ÿæ˜¯é¦¬å¾·é‡Œçœ‹å¤•é™½æœ€å¥½çš„åœ°æ–¹ã€‚", highlight: false }
                    ]
                },
                {
                    date: "2/25 (ä¸‰)",
                    title: "æœ€å¾Œçš„æ¼«æ­¥èˆ‡å‘Šåˆ¥",
                    activities: [
                        { time: "10:00", desc: "æ¼«æ­¥ **Barrio de las Letras (æ–‡å­¸å€)**ã€‚é€™è£¡æ˜¯å¡è¬ææ–¯æ›¾å±…ä½çš„åœ°æ–¹ï¼Œåœ°æ¿ä¸Šåˆ»æœ‰è©©å¥ã€‚", highlight: true },
                        { time: "14:00", desc: "æœ€å¾Œçš„æ¡è³¼ (æ©„æ¬–æ²¹ã€ä¼Šæ¯”åˆ©ç«è…¿çœŸç©ºåŒ…)ã€‚", highlight: false },
                        { time: "18:00", desc: "æ‰¾ä¸€å®¶å‚³çµ±çš„ ChocolaterÃ­a åƒå‰æ‹¿æ£’ (Churros) é…ç†±å·§å…‹åŠ›ã€‚", highlight: false }
                    ]
                },
                {
                    date: "2/26 (å››)",
                    title: "è¿”å›é‡Œæ–¯æœ¬",
                    activities: [
                        { time: "ä¸Šåˆ", desc: "æ•´ç†è¡Œæã€‚", highlight: false },
                        { time: "ä¸‹åˆ", desc: "å‰å¾€é¦¬å¾·é‡Œæ©Ÿå ´ (MAD)ã€‚æ­ä¹˜é£›æ©Ÿè¿”å›é‡Œæ–¯æœ¬ (LIS)ã€‚", highlight: true },
                        { time: "19:00", desc: "æŠµé”é‡Œæ–¯æœ¬ã€‚å…¥ä½æ©Ÿå ´é™„è¿‘çš„é£¯åº— (å¦‚ MeliÃ¡, Star Inn)ï¼Œæ–¹ä¾¿éš”å¤©æ—©ç­æ©Ÿã€‚", highlight: true },
                        { time: "20:00", desc: "æœ€å¾Œæ™šé¤ã€‚", highlight: false }
                    ]
                },
                {
                    date: "2/27 (äº”)",
                    title: "è¿”ç¨‹",
                    activities: [
                        { time: "05:55", desc: "é‡Œæ–¯æœ¬æ©Ÿå ´èµ·é£›ã€‚å¸¶è‘—æ»¿æ»¿å›æ†¶å›å®¶ã€‚", highlight: true }
                    ]
                }
            ]
        };

        // --- Logic Layer ---

        // 1. Initialize Charts
        function initCharts() {
            // Timeline Chart
            const ctxTimeline = document.getElementById('timelineChart').getContext('2d');
            new Chart(ctxTimeline, {
                type: 'bar',
                data: {
                    labels: ['é‡Œæ–¯æœ¬ (é¦–)', 'ç“¦å€«è¥¿äº', 'é¦¬å¾·é‡Œ', 'é‡Œæ–¯æœ¬ (æœ«)'],
                    datasets: [{
                        label: 'å¤©æ•¸',
                        data: [ [14, 18], [18, 21], [21, 26], [26, 27] ], // Simplified date ranges
                        backgroundColor: [
                            'rgba(225, 112, 85, 0.8)', // Terracotta
                            'rgba(253, 203, 110, 0.8)', // Mustard
                            'rgba(116, 185, 255, 0.8)', // Blue
                            'rgba(225, 112, 85, 0.8)'
                        ],
                        borderColor: [
                            'rgba(225, 112, 85, 1)',
                            'rgba(253, 203, 110, 1)',
                            'rgba(116, 185, 255, 1)',
                            'rgba(225, 112, 85, 1)'
                        ],
                        borderWidth: 1,
                        barPercentage: 0.6
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const raw = context.raw;
                                    return `2æœˆ${raw[0]}æ—¥ - 2æœˆ${raw[1]}æ—¥`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            min: 14,
                            max: 27,
                            title: { display: true, text: '2026å¹´ 2æœˆæ—¥æœŸ' },
                            ticks: { stepSize: 1 }
                        }
                    }
                }
            });

            // Budget Chart
            const ctxBudget = document.getElementById('budgetChart').getContext('2d');
            new Chart(ctxBudget, {
                type: 'doughnut',
                data: {
                    labels: ['ä½å®¿', 'åŸéš›äº¤é€š', 'é¤é£²', 'é–€ç¥¨/çƒè³½', 'è³¼ç‰©/é›œæ”¯'],
                    datasets: [{
                        data: [40, 20, 20, 10, 10],
                        backgroundColor: [
                            '#d4a373', // Sand
                            '#e17055', // Terracotta
                            '#fab1a0', // Light Orange
                            '#74b9ff', // Blue (Football)
                            '#b2bec3'  // Grey
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'right' }
                    }
                }
            });
        }

        // 2. City Switching Logic
        function switchCity(cityKey) {
            // Update Tabs
            document.querySelectorAll('button[id^="tab-"]').forEach(btn => {
                btn.className = "tab-inactive px-4 py-4 text-sm md:text-lg font-medium focus:outline-none whitespace-nowrap";
            });
            document.getElementById(`tab-${cityKey}`).className = "tab-active px-4 py-4 text-sm md:text-lg font-medium focus:outline-none whitespace-nowrap";

            // Render Content
            const container = document.getElementById('itinerary-content');
            container.innerHTML = ''; // Clear

            const days = itineraryData[cityKey];
            
            // Create Grid
            const grid = document.createElement('div');
            grid.className = "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6";

            days.forEach(day => {
                const card = document.createElement('div');
                card.className = "bg-white rounded-lg shadow border border-gray-100 p-6 card-hover flex flex-col h-full";
                
                // Card Header
                let headerHTML = `
                    <div class="flex justify-between items-center mb-4 pb-2 border-b border-gray-100">
                        <span class="text-orange-600 font-bold">${day.date}</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800 mb-2">${day.title}</h3>
                `;
                
                if (day.intro) {
                    headerHTML += `<p class="text-sm text-gray-500 mb-4 italic">${day.intro}</p>`;
                }

                // Activities List
                let listHTML = `<ul class="space-y-4 flex-grow">`;
                day.activities.forEach(act => {
                    const highlightClass = act.highlight ? "text-gray-900 font-medium" : "text-gray-500";
                    const icon = act.highlight ? "ğŸ”¹" : "â–«ï¸";
                    listHTML += `
                        <li class="flex items-start text-sm">
                            <span class="mr-2 mt-0.5 text-xs">${icon}</span>
                            <div>
                                <span class="block text-xs text-gray-400 font-mono">${act.time}</span>
                                <span class="${highlightClass}">${parseMarkdown(act.desc)}</span>
                            </div>
                        </li>
                    `;
                });
                listHTML += `</ul>`;

                card.innerHTML = headerHTML + listHTML;
                grid.appendChild(card);
            });

            container.appendChild(grid);
        }

        // Helper to bold text like markdown
        function parseMarkdown(text) {
            return text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
        }

        // Scroll Helper
        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            initCharts();
            switchCity('lisbon'); // Default view
        });

    </script>
</body>
</html>
